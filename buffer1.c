
#include <stdio.h>
#include <string.h>

#include <errno.h>
#include <linux/unistd.h>
#include <linux/kernel.h>
#include <sys/sysinfo.h>

#include <stdlib.h>
#include <time.h>

int main(void) {

    char buffer[15];
    int is_password_correct = 0;

    printf("\nKaribu Mfumo wa M-PESA");
    printf("\n=====================================");
    printf("\n1) Generate token kwa umeme.");
    printf("\n2) View system uptime.");
    printf("\n3) Exit.");

    printf("\n\nIngiza namba:");
    char choice = getchar();
    getchar();

    if (choice == '1') {
      printf("\nEnter the password: ");
      gets(buffer);
      // TODO: Replace "PASSWORD" with a strong password
      // of your choice (15 characters or less).
      if(strcmp(buffer, "PASSWORD") != 0) {
        printf("\nIncorrect password; you aren't allowed to create tokens.\n");
      } else {
        printf("\nCorrect password.\n");
        is_password_correct = 1;
      }

      if (is_password_correct) {
        printf("Generating token...\n");
        srand(time(NULL));
        printf("Token: %d %d %d %d",
            rand() % 10000, rand() % 10000, rand() % 10000, rand() % 10000);
        printf("\nKwa heri.\n");
      }
    } else if (choice == '2') {
      struct sysinfo s_info;
      int error = sysinfo(&s_info);
      if(error != 0) {
        printf("\nUnable to get uptime; error code: %d\n", error);
      }
      printf("\nSystem up for %d seconds.\n", s_info.uptime);
    } else if (choice == '3') {
      printf("\nKwa heri.\n");
    } else {
      printf("\nUnknown choice. Exiting.\n");
    }
}
